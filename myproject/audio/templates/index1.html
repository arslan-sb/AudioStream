{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Audio List</title>

    <!-- Video.js CSS -->
    <link href="https://vjs.zencdn.net/7.14.3/video-js.css" rel="stylesheet" />

    <!-- HLS.js -->
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <style>
        body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
    </style>

    <script>
        // Disable right-click context menu
        document.addEventListener('contextmenu', function(e) {
            if (e.target.tagName === 'VIDEO' || e.target.tagName === 'SOURCE') {
                e.preventDefault();
            }
        }, false);

        // Disable drag and drop on video elements
        document.addEventListener('dragstart', function(e) {
            if (e.target.tagName === 'VIDEO' || e.target.tagName === 'SOURCE') {
                e.preventDefault();
            }
        }, false);

        document.addEventListener('drop', function(e) {
            if (e.target.tagName === 'VIDEO' || e.target.tagName === 'SOURCE') {
                e.preventDefault();
            }
        }, false);
    </script>

</head>
<body>

    <h1>Audio Files</h1>
    <ul id="audioList">
        {% for audio in audio_files %}
            <li>
                <h2>{{ audio }}</h2>
                <video id="audio_player_{{ forloop.counter }}" 
                class="video-js vjs-default-skin" 
                controls preload="none" width="640" height="40">
                    <!-- Video element with controls and HLS.js integration -->
                </video>
                <script>
                    document.addEventListener('DOMContentLoaded', function() {
                        const video = document.getElementById('audio_player_{{ forloop.counter }}');
                        if (Hls.isSupported()) {
                            const hls = new Hls();
                            hls.loadSource("{% url 'serve_audio' audio %}");
                            hls.attachMedia(video);
                        } else if (video.canPlayType('application/vnd.apple.mpegurl')) {
                            video.src = "{% url 'serve_audio' audio %}";
                        }
                    });
                </script>
            </li>
        {% endfor %}
    </ul>

</body>
</html>
